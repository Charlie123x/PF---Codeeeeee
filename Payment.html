<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Payment Method</title>
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="Payment.css">
</head>
<body>

  <!-- Back Button -->
  <a href="Menu.html" class="back-icon"><i class='bx bx-arrow-back'></i></a>

  <h1>Payment Method</h1>

  <!-- Cart Container -->
  <div id="cart-items-container"></div>

  <h2>Select Payment Method</h2>
  <button class="payment-button" id="gcash-btn">GCash</button>
  <button class="payment-button" id="paymaya-btn">PayMaya</button>
  <button class="payment-button" id="paypal-btn">PayPal</button>

  <!-- Receipt Display -->
  <div class="receipt" id="receipt" style="display:none;">
    <h2>Payment Receipt</h2>
    <div id="receipt-items"></div>
    <p><strong>Total:</strong> ₱<span id="receipt-total-price"></span></p>
    <p><strong>Payment Method:</strong> <span id="receipt-payment-method"></span></p>
    <p><strong>Status:</strong> Paid successfully!</p>
  </div>

<script>
  // Get cart from URL
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  const cartParam = getQueryParam("cart");
  let cartItems = [];

  try {
    cartItems = JSON.parse(decodeURIComponent(cartParam)) || [];
  } catch (e) {
    console.error("Failed to parse cart data:", e);
  }

  const cartContainer = document.getElementById("cart-items-container");

  // Display items in the cart
  cartItems.forEach(item => {
    const itemHTML = `
      <div class="selected-drink">
        <img src="${item.image}" width="100" />
        <h2>${item.name}</h2>
        <p>₱${item.price}</p>
        <p>Quantity: ${item.quantity}</p>
      </div>
    `;
    cartContainer.insertAdjacentHTML("beforeend", itemHTML);
  });

  // Correct total with quantity calculation
  const totalPrice = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);

  // Handle payment method selection
  const paymentButtons = document.querySelectorAll('.payment-button');
  paymentButtons.forEach(button => {
    button.addEventListener('click', (event) => {
      const paymentMethod = event.target.id.replace('-btn', '').toUpperCase();

      // Create the receipt content for the alert
      let receiptContent = `Payment Method: ${paymentMethod}\n`;
      receiptContent += `Total: ₱${totalPrice}\n\nItems:\n`;

      cartItems.forEach(item => {
        receiptContent += `${item.name} - ₱${item.price} × ${item.quantity}\n`;
      });

      // Show the receipt in an alert box
      alert(receiptContent);
    });
  });
</script>


</body>
</html>
